<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
	 .scrollabletextbox {
		height:300px;
		width:400px;
		background:  #abebc6;
		font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif;
		font-size: 82%;
		overflow:scroll;
		}
	</style>
    
	<script type="text/javascript" src="data.js"></script>
	<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
	<script src='https://code.responsivevoice.org/responsivevoice.js'></script>
	<script>
	  //----This ensure that when people hit a return key, they insert br element
	  //---not used
	  document.execCommand("defaultParagraphSeparator", false, "br");
	  $(document).ready(function() {
	    document.getElementById("playpasted").style.visibility = "hidden"; 
		document.getElementById("spkStop").style.visibility = "hidden"
	
	    //----Detect user input into textarea
		$("#editTA").change(function() {
		   //alert('Textarea is changed');
		   document.getElementById("playpasted").style.visibility = "visible"; 
		   var sh2=document.getElementById("shw2");
 

		   sh2.innerHTML="Textarea is changed";
		   setTimeout(function(){ sh2.innerHTML=" "; }, 2000);
		});	  
	  
	  
	  
		   

	 
	        
	 
	 
	 
	 
	 });//$(document).ready

   
		

	</script>

	
	
   </head>
  <body>
    <section class="page-header">
      <h1 class="project-name"></h1>
    </section>

    <section class="main-content">
    <h2 style="text-align:left;" onclick="MMenu();"  >&#9776;</h2>
    <h2 style="text-align:left;" onclick="MMenu();"  >&#9776;</h2>


	<br/>
    <input onclick="gWdSpk();" type='button' value='ðŸ”Š Play Embedded' />
    <input id="playpasted" onclick="pasteSpk();" type='button' value='ðŸ”Š Play Pasted ' />
    <input id="spkStop" onclick="responsiveVoice.speak('');" type='button' value='ðŸ”Š Stop' />
	<br/>
	<textarea class="scrollabletextbox" contenteditable="true" name="note" value="" id="editTA">
	Paste your Word-phrase into the green box.      
	Separate each paragraph with a blank space.
		   
	</textarea>
	<p id="shw1" >Click the Play button</p>
	<p id="shw2" ></p>
	  
<!--	
    <p contenteditable="true" id="editp" class="scrollabletextbox">
	P-element.  Paste your Word-phrase here. Separate each paragraph by a blank space.
	</p> 

    <input onclick="updateWdphrase();" type='button' value='ðŸ”Š Update P element' />
	

     <br/>
    <input onclick="updateTA();" type='button' value='ðŸ”Š Update Textarea' />
-->	
    </section>
  </body>
  
  	<script>
	     var phtotal=0, e1=0, e2=0, rnum=0;
		 var str1=" ";
		 var str2="";
		     
		 phtotal=mywd.Sheet1.length;
		 e1 = document.getElementById("shw1"); 
		 e2 = document.getElementById("shw2"); 
         rnum= Math.floor(Math.random() * phtotal);     // if is 10, returns a random integer from 0 to 9 
	    //phtotal=mywd.Sheet1.length;
	     rnum= Math.floor(Math.random() * phtotal);  
		 
	  function MMenu()	 {
	  
	  }

      function contEmbedSpk(){
	     gWdSpk();
	  
	  }
	  function embedSpkEnd() {
			//$("#log").text('fnished playing');
			alert('finished playing');
			//contEmbedSpk();
			
		  };	
	         
	  function gWdSpk(){
		 //phtotal=mywd.Sheet1.length;
		 document.getElementById("spkStop").style.visibility = "visible";

		 e1 = document.getElementById("shw1"); 
		 //e2 = document.getElementById("shw2"); 
          var radn= Math.floor(Math.random() * phtotal);     // if is 10, returns a random integer from 0 to 9 
		  e1.innerHTML =mywd.Sheet1[radn].Phrases;
		  var txt=mywd.Sheet1[radn].Phrases
	      //responsiveVoice.speak(txt);
		  //responsiveVoice.speak(txt, 'UK English Male', {onend: embedSpkEnd});
          // responsiveVoice.speak(txt, 'UK English Female');//work in mobile
		  responsiveVoice.speak(txt, 'US English Female', {onend: embedSpkEnd}); //mobile  onend not working
		        
	  }	 
	          
	    
             
      function contPasteSpk(){
	     pasteSpk();
	  
	  }
	  function pasteSpkEnd() {
			//$("#log").text('fnished playing');
			//alert('finished playing');
			contPasteSpk();
			
		  };
	  
	  
	  function pasteSpk(){
		 document.getElementById("spkStop").style.visibility = "visible";
	     var taTxt=document.getElementById("editTA").value;
		 var s=taTxt.split(/\n\s*\n/); //detect empty line and split them into array
		// var nump=s.length; // total paragraph
		 var phtotal=s.length; // total paragraph
		 e1 = document.getElementById("shw1"); 
		 //e2 = document.getElementById("shw2"); 
          var radn= Math.floor(Math.random() * phtotal);     // if is 10, returns a random integer from 0 to 9 
		  e1.innerHTML =s[radn]
		  var txt=s[radn];
	     // responsiveVoice.speak(txt);
		  responsiveVoice.speak(txt, 'UK English Male', {onend: pasteSpkEnd});
	  
	  }
	     


	      

	  function updateWdphrase(){
	     var obj=document.getElementById("editp");
	     alert(obj.innerHTML)
	  }
	  //------not used
	  function updateTA(){
	    // var obj=document.getElementById("editTA");
	     var taTxt=document.getElementById("editTA").value;
		 
		 //var s = taTxt.split(/\r?\n/);
		 var s=taTxt.split(/\n\s*\n/); //detect empty line and split them into array
		 
		 var nump=s.length; // total paragraph
		// alert(nump.toString());

		 var txt="Total paragraph="+nump.toString();
	     alert(txt.concat("\n 1) ",s[0],"\n 2) ",s[1], "\n 3) ", s[2]));
	  } 
    
	     
	
	</script>
  
  
</html>

