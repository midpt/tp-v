<!DOCTYPE html>
<html lang="en-us">
  <head>    
    <meta charset="UTF-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
	 .scrollabletextbox {
	    float: left;
	 	width:410px;
		height:200px;
        background: url(images/green.jpg);
		background:  #abebc6;
		font-family: Verdana, Tahoma, Arial, Helvetica, sans-serif;
		font-size: 82%;
		overflow:scroll;
		}
	.shw1{
	      margin: auto;
 		  border: 1px solid black;
		  padding: 10px;
		  width: 390px;
		  height: 200px;
		  float: left;
		  text-align: center;
		  background: url(images/a.jpg);
		  background-size: cover;
		  overflow:scroll;
		  position: relative;
		}	
	</style>
        
	<script type="text/javascript" src="data.js"></script>
	<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
	<script src='https://code.responsivevoice.org/responsivevoice.js'></script>
	<script>
	  //----This ensure that when people hit a return key, they insert br element
	  //---not used
	  document.execCommand("defaultParagraphSeparator", false, "br");
	  $(document).ready(function() {
	    document.getElementById("playpasted").style.visibility = "hidden"; 
		document.getElementById("spkStop").style.visibility = "hidden"
		document.getElementById("us_").style.visibility = "hidden"
		document.getElementById("uk_").style.visibility = "hidden"
		document.getElementById("chinese_").style.visibility = "hidden"
		document.getElementById("japanese_").style.visibility = "hidden"
	
	    //----Detect user input into textarea
		$("#editTA").change(function() {
		   //alert('Textarea is changed');
		   document.getElementById("playpasted").style.visibility = "visible"; 
		   var sh2=document.getElementById("shw2");
 

		   //sh2.innerHTML="Textarea is changed";
		   //setTimeout(function(){ sh2.innerHTML=" "; }, 2000);
		});	  
	  
	  
	  
		   

	 
	        
	 
	 
	 
	 
	 });//$(document).ready

   
		

	</script>

	
	
   </head>
  <body>
    <section class="page-header">
      <h1 class="project-name"></h1>
    </section>

    <section class="main-content">
<!--    <h2 style="text-align:left;" onclick="MMenu();"  >&#9776;</h2>   -->
  

 <form name="theForm"> 
 <span id="us_"><input type="checkbox" id="us" name="theGroup" onClick="clearGroup(this);">US </span>
  <span id="uk_"><input type="checkbox" id="uk" name="theGroup" onClick="clearGroup(this);">UK</span>
    <br />
  <span id="chinese_">     <input type="checkbox" id="chinese" name="theGroup" onClick="clearGroup(this);">Chinese</span>
  <span id="japanese_">     <input type="checkbox" id="japanese" name="theGroup" onClick="clearGroup(this);">Japanese</span>

</form> 
  
  
  
	<br/>
    <input onclick="gWdSpk();" type='button' value='ðŸ”Š Play Embedded' />
    <input id="playpasted" onclick="pasteSpk();" type='button' value='ðŸ”Š Play Pasted ' />
    <input id="spkStop" onclick="responsiveVoice.cancel();" type='button' value='ðŸ”Š Stop' />
	
	<br><br>

       
    
	<p id="shw1" class="shw1">Click 'Play Embedded'</p>
	<p id="shw2" class="shw2"></p>
	<br><br><br><br><br><br><br><br><br><br><br><br><br><br>
          
<textarea class="scrollabletextbox" contenteditable="true" name="note" value="" id="editTA">
Paste your own Word-phrase into the green box.      
Separate each paragraph with a blank space.
Once you have completed, tap outside the box.
</textarea>	  
	
       
	<!--	
    <p contenteditable="true" id="editp" class="scrollabletextbox">
	P-element.  Paste your Word-phrase here. Separate each paragraph by a blank space.
	</p> 

    <input onclick="updateWdphrase();" type='button' value='ðŸ”Š Update P element' />
	

     <br/>
    <input onclick="updateTA();" type='button' value='ðŸ”Š Update Textarea' />
-->	
    </section>
  </body>
  
  	<script>
	     var phtotal=0, e1=0, e2=0, rnum=0;
		 var str1=" ";
		 var str2="";
		     
		 phtotal=mywd.Sheet1.length;
		 e1 = document.getElementById("shw1"); 
		 e2 = document.getElementById("shw2"); 
         rnum= Math.floor(Math.random() * phtotal);     // if is 10, returns a random integer from 0 to 9 
	    //phtotal=mywd.Sheet1.length;
	     rnum= Math.floor(Math.random() * phtotal);  
		 
		 //-----Derive available voice list
		 var voicelist = responsiveVoice.getVoices();
		 var voiceTotal=voicelist.length;
		 for (n=0;n<voiceTotal;n++){
		    if (voicelist[n].name.toUpperCase().indexOf("US ") !=-1) {
			   document.getElementById("us_").style.visibility ="visible";
			}
		    if (voicelist[n].name.toUpperCase().indexOf("UK ") !=-1) {
			   document.getElementById("uk_").style.visibility ="visible";
			}
		    if (voicelist[n].name.toUpperCase().indexOf("JAPANESE ") !=-1) {
			   document.getElementById("japanese_").style.visibility ="visible";
			}		 
		    if (voicelist[n].name.toUpperCase().indexOf("CHINESE ") !=-1) {
			   document.getElementById("chinese_").style.visibility ="visible";
			}		 
		}
	    	        
		 
	  function MMenu()	 {
	  
	  }

      function contEmbedSpk(){
	   setTimeout(function(){  gWdSpk(); }, 2000);
	     //gWdSpk();  
	     
	  }
	  function embedSpkEnd() {
			//$("#log").text('fnished playing');
			//alert('finished playing');
			contEmbedSpk();
			
		  };	
	         
	  function gWdSpk(){
		 //phtotal=mywd.Sheet1.length;
		 document.getElementById("spkStop").style.visibility = "visible";

		 e1 = document.getElementById("shw1"); 
		 //e2 = document.getElementById("shw2"); 
          var radn= Math.floor(Math.random() * phtotal);     // if is 10, returns a random integer from 0 to 9 
		  e1.innerHTML =mywd.Sheet1[radn].Phrases;
		  var txt=mywd.Sheet1[radn].Phrases
	      //responsiveVoice.speak(txt);
		  //responsiveVoice.speak(txt, 'UK English Male', {onend: embedSpkEnd});
          // responsiveVoice.speak(txt, 'UK English Female');//work in mobile
		  // responsiveVoice.speak(txt, 'UK English Female', {onend: embedSpkEnd});//uk voice with callback mobile not working
		  responsiveVoice.speak(txt, 'US English Female', {onend: embedSpkEnd}); //mobile  onend not working
		        
	  }	 
	                  
	          
             
      function contPasteSpk(){
	     setTimeout(function(){  pasteSpk(); }, 2000);
	     //pasteSpk();
	      
	  }
	  function pasteSpkEnd() {
			//$("#log").text('fnished playing');
			//alert('finished playing');
			contPasteSpk();
			
		  };
	     
	  
	  function pasteSpk(){
		 document.getElementById("spkStop").style.visibility = "visible";
	     var taTxt=document.getElementById("editTA").value;
		 var s=taTxt.split(/\n\s*\n/); //detect empty line and split them into array
		// var nump=s.length; // total paragraph
		 var phtotal=s.length; // total paragraph
		 e1 = document.getElementById("shw1"); 
		 //e2 = document.getElementById("shw2"); 
          var radn= Math.floor(Math.random() * phtotal);     // if is 10, returns a random integer from 0 to 9 
		  e1.innerHTML =s[radn]
		  var txt=s[radn];
	     // responsiveVoice.speak(txt);
		  responsiveVoice.speak(txt, 'US English Female', {onend: pasteSpkEnd});
	  
	  }
	 
    //----checkboxes checked & unchecked	 
    function clearGroup(elem) {
        var group = document.theForm.theGroup;
        for (var i=0; i<group.length; i++) {
            if (group[i] != elem) {
                group[i].checked = false;
            }
        }
    }
      
	        

	  function updateWdphrase(){
	     var obj=document.getElementById("editp");
	     alert(obj.innerHTML)
	  }
	  //------not used
	  function updateTA(){
	    // var obj=document.getElementById("editTA");
	     var taTxt=document.getElementById("editTA").value;
		 
		 //var s = taTxt.split(/\r?\n/);
		 var s=taTxt.split(/\n\s*\n/); //detect empty line and split them into array
		 
		 var nump=s.length; // total paragraph
		// alert(nump.toString());

		 var txt="Total paragraph="+nump.toString();
	     alert(txt.concat("\n 1) ",s[0],"\n 2) ",s[1], "\n 3) ", s[2]));
	  } 
    
	     
	
	</script>
  
  
</html>

